name: Quick Debug

on: [push]

jobs:
  debug:
    runs-on: self-hosted
    
    steps:
    - name: Test 1 - Basic info
      run: |
        echo "Current directory: %CD%"
        echo "Current user: %USERNAME%"
        dir
        
    - name: Test 2 - Checkout
      uses: actions/checkout@v4
      
    - name: Test 3 - After checkout
      run: |
        echo "After checkout:"
        dir
        echo "Looking for deploy.bat:"
        if exist "deploy.bat" (
            echo "deploy.bat found!"
            type deploy.bat
        ) else (
            echo "deploy.bat NOT found!"
        )
        
    - name: Test 4 - PowerShell version
      shell: powershell
      run: |
        Write-Host "PowerShell version: $($PSVersionTable.PSVersion)"
        Write-Host "Current directory: $PWD"
        
    - name: Test 5 - Telegram test (simple)
      shell: powershell
      run: |
        try {
            $token = "${{ secrets.TELEGRAM_BOT_TOKEN }}"
            if ($token) {
                Write-Host "Token length: $($token.Length)"
                $url = "https://api.telegram.org/bot$token/getMe"
                Write-Host "Testing Telegram API..."
                $response = Invoke-RestMethod -Uri $url -Method Get -TimeoutSec 5
                Write-Host "Telegram API response: $($response.ok)"
            } else {
                Write-Host "No token provided"
            }
        }
        catch {
            Write-Host "Telegram error: $($_.Exception.Message)"
        }
      continue-on-error: true
